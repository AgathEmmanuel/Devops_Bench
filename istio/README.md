

# istio  


Simplify observability, traffic management, security, and policy with the leading service mesh.  


- traffic Management
- ingress gateways  
- virtual services  
- destination rule (map configurign rules to link specific labels in k8s model to subsets in istio model )  
- advanced route rules (route to specific versions based on requests )
- istio load-balancing ratios  
- routing for canary deployment  
- testing a new release with canary  
- MTLS credentials  ( mutual TLS endpoint )  
- OpenTracing  
- Jaeger UI  
- request latencies  
- multi-service path  
- Policy Enforcement
- injecting faults in service response (to see how system interacts with faults)   
- add force aborts in needed applications (when service request comes its aborted )   
- mirroring connections (2 subset,1 for main traffic and 1 for mirrored trafic)  
- ciruit breaker test with timeouts (virtuaservice edited to add delay to requests) 
- observability




while [ 1 ];do curl http://$(minikube ip):31575/version/ ;done  
watch curl   



Traffic Management in Istio

The following CRDs are defined in Istio to help users with traffic management.

    Gateway:

Gateway describes a load balancer that runs at the edge of the network and is used to receive incoming or outgoing HTTP/TCP connections.

    VirtualService:

 VirtualService actually connects the Kubernetes service to the Istio Gateway. It can also perform additional operations, such as defining a set of traffic routing rules to be applied when a host is addressed.

    DestinationRule:

 The policy defined by the DestinationRule determines the access policy for the traffic after it has been routed. Simply put, it defines how traffic is routed. Among others, these policies can be defined as load balancing configurations, connection pool sizes, and external detection (for identifying and expelling unhealthy hosts in the load balancing pool) configurations.

    EnvoyFilter:

 The EnvoyFilter object describes filters for proxy services that can customize the proxy configuration generated by Istio Pilot. This configuration is generally rarely used by primary users.

    ServiceEntry:

 By default, services in the Istio service mesh are unable to discover services outside of the Mesh. ServiceEntry enables additional entries to be added to the service registry inside Istio, thus allowing automatically discovered services in the mesh to access and route to these manually added services.





## Service Discovery  


changes require code updates  
dynamic URLs in the cloud  
load balancing  
multiple environments  

kubernetes solves service discovery not istio  
Kubernetes is essentially about application lifecycle management through declarative configuration,
while a service mesh is essentially about providing inter-application traffic, security management and observability.
If you have already built a stable application platform using Kubernetes, 
how do you set up load balancing and traffic control for calls between services? This is where a service mesh comes into the picture.

A service mesh is based on transparent proxies that intercept traffic between services through sidecar proxies, and then manage the behavior of them through control plane configuration.
A service mesh decouples traffic management from Kubernetes, eliminating the need for a kube-proxy component to support traffic within service mesh; and managing inter-service traffic, security and observability by providing an abstraction closer to the microservice application layer.
xDS is one of the protocol standards for service mesh configuration.
A service mesh is a higher-level abstraction of service in Kubernetes.


## Why use Istio? 

Istio enables organizations to secure, connect, and monitor microservices, 
so they can modernize their enterprise apps more swiftly and securely.

Istio’s traffic routing rules let you easily control the flow of traffic and API calls between services. 
Istio simplifies configuration of service-level properties like circuit breakers, timeouts, and retries, 
and makes it easy to set up important tasks like A/B testing, canary rollouts, and staged rollouts with percentage-based traffic splits. 
It also provides out-of-box reliability features that help make your application more resilient against failures of dependent services or the network.

Istio’s traffic management model relies on the Envoy proxies that are deployed along with your services. 
All traffic that your mesh services send and receive (data plane traffic) is proxied through Envoy, 
making it easy to direct and control traffic around your mesh without making any changes to your services.


## Links  

[https://istio.io/](https://istio.io/)
[https://istio.io/latest/docs/examples/microservices-istio/](https://istio.io/latest/docs/examples/microservices-istio/)  
[https://istio.io/latest/docs/ops/deployment/architecture/](https://istio.io/latest/docs/ops/deployment/architecture/)  
[https://istio.io/latest/docs/concepts/traffic-management/](https://istio.io/latest/docs/concepts/traffic-management/)  
[https://thenewstack.io/why-do-you-need-istio-when-you-already-have-kubernetes/](https://thenewstack.io/why-do-you-need-istio-when-you-already-have-kubernetes/)  
[https://www.ibm.com/docs/en/cloud-private/3.2.0?topic=discovery-enabling-istio-service](https://www.ibm.com/docs/en/cloud-private/3.2.0?topic=discovery-enabling-istio-service)  
[https://istio.io/latest/docs/ops/configuration/traffic-management/protocol-selection/](https://istio.io/latest/docs/ops/configuration/traffic-management/protocol-selection/)  
[https://cloud.google.com/learn/what-is-istio](https://cloud.google.com/learn/what-is-istio)  
[https://cloud.google.com/blog/products/devops-sre/the-service-mesh-era-using-istio-and-stackdriver-to-build-an-sre-service](https://cloud.google.com/blog/products/devops-sre/the-service-mesh-era-using-istio-and-stackdriver-to-build-an-sre-service)  
[https://cloud.google.com/migrate/compute-engine/docs/4.8/how-to/monitoring/using-stackdriver-monitoring](https://cloud.google.com/migrate/compute-engine/docs/4.8/how-to/monitoring/using-stackdriver-monitoring)  
[https://medium.com/avmconsulting-blog/service-discovery-for-microservices-with-kubernetes-bf4353953553](https://medium.com/avmconsulting-blog/service-discovery-for-microservices-with-kubernetes-bf4353953553)  
[https://github.com/GoogleCloudPlatform/istio-samples/tree/master/istio-stackdriver](https://github.com/GoogleCloudPlatform/istio-samples/tree/master/istio-stackdriver)  
